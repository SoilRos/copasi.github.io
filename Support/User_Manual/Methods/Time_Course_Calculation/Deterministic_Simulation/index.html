---
layout: structure
title: "Deterministic Simulation"
structure: "User_Manual"
use_math: true
---

<div class="row">
  <div class="col-xs-12">

<h3 name="Deterministic_LSODA_">Deterministic (LSODA or LSODAR)</h3>
<p>
The default methods in COPASI to calculate a time course are LSODA or
LSODAR [<a title="COPASI: Support/User Manual/Bibliography" 
href="{{ site.baseurl }}/Support/User_Manual/Bibliography#Petzold83/">
Petzold83</a>]. Both methods are part of
the <a target="_blank" href="http://www.netlib.org/odepack/opkd-sum"
       rel="external"> ODEPACK</a> library 
[<a title="COPASI: Support/User Manual/Bibliography"
href="{{ site.baseurl }}/Support/User_Manual/Bibliography#Hindmarsh83">
Hindmarsh83</a>]. LSODA was written by Linda R. Petzold and Alan C. Hindmarsh.It solves
systems $\frac{dy}{dt} = f(t, y)$ with a dense or banded Jacobian when
the problem is stiff, but it automatically selects between non-stiff
(Adams) and stiff (BDF) methods.  It uses the non-stiff method
initially, and dynamically monitors data in order to decide which
method to use. LSODAR adds root finding capabilities to LSODA which
are used to detect the exact location in time when 
<a title="COPASI: Support/User Manual/Model Creation/Events"
   href="{{ site.baseurl }}/Support/User_Manual/Model_Creation/Events/">
events</a> occur. COPASI automatically chooses the apropriate
method for any given problem.
</p>

<h4 name="Options_for_LSODA">Options for LSODA</h4>

<dl><dt><b>Integrate Reduced Model</b></dt><dd> This parameter is a
    boolean value to determine whether the integration shall be
    performed using the mass conservation laws, i.e., reducing the
    number of system variables or to use the complete model. A value
    of '1' (the default) instructs COPASI to make use of the mass
    conservation laws, whereas a value of '0' instructs COPASI to
    determine all variables through ODEs.</dd></dl>
<dl><dt><b>Relative Tolerance</b></dt><dd> This parameter is a numeric
    value specifying the desired relative tolerance the user wants to
    achieve. A smaller value means that the trajectory is calculated
    more accurate. The default value is $1.0 \cdot 10^{-6}$. Please
    note that best achievable relative tolerance is $2.22 \cdot 10^{-16}$ 
    approximately.</dd></dl>
<dl><dt><b>Absolute Tolerance</b></dt><dd> This parameter is a
    positive numeric value specifying the desired absolute tolerance
    the user wants to achieve. Please note that for species the
    absolute tolerance is applied to the concentration value. The
    default value is $1.0 \cdot 10^{-12}$.</dd></dl>
<dl><dt><b>Max Internal Steps</b></dt><dd> This parameter is a
    positive integer value specifying the maximal number of internal
    steps the integrator is allowed to take before the next desired
    reporting time. The default value is '10000'.</dd></dl>
<dl><dt><b>Max Internal Step Size</b></dt><dd> This parameter is a
    positive double value specifying the maximal size of an internal
    steps the integrator is allowed to take. The default '0' means
    that there is no such limit.</dd></dl>
  </div>
</div>
